# toxic_bert

В этом репозитории представлена программа, написанная по заданию на стажировку. Программа выполняет классификацию данных в формате csv BERT'ом на два класса.

В режиме инференса программа получает на вход csv файл с двумя столбцами (данные и метка класса), а также файл с весами модели (на вход функции подается уже загруженая пайторч модель или файл с ВЕСАМИ).
Запустить программу можно путем вызова функции inference() в модуле predict_csv.py или через консоль.

Для запуска через консоль:
> python -m predict_csv --data_path <Путь к csv файлу с данными> --model_path <путь к файлу с весами модели> --data_name <название столбца с данными> --label_name <название столбца с метками класса>

Например, если поместить файл data_test_public.csv и модель model_dict.pt в одну папку со скриптом predict_csv, то будет валидна следующая команда:
> python -m predict_csv --data_path data_test_public.csv --data_name comment --label_name toxic

Сформированный датафрейм со столбцами предсказаний записывается в файл output.csv

Также в модуле train.py написан скрипт для обучения модели. Скрипт не оттестирован полностью, т.к. берт не влез в память видеокарты
Запускается обучение вызовом функции main() или через консоль
> python -m train --data_path <путь к csv файлу с тренировочным датасетом> --data_name <имя столбца с данными> --label_name <имя столбца с метками класса>

(Например python -m train --data_path data_train.csv --data_name comment --label_name toxic)

Обученная модель записывается в файлы model.pt и model_dict.pt


В репозитории есть несколько файлов. В папке src содержатся модули:

- toxic_bert.py - код кастомного датасета и класс архитектуры модели
- preprocessing.py - функции для минимальной обработки входящего датасета

В модуле predict_csv.py описаны функции для предсказания клссов, а в модуле train.py функции для обучения модели
